---
title: "Landscape of Change Results for Birds"
output: html_document
---

```{r setup, include=FALSE}
require(knitr)
require(utils)
require(dplyr)
require(ggplot2)
library(ggmap)
library(tidyverse)

freq.table <- read.csv('frequency_table_data.csv', header = TRUE)
freq.plot <- read.csv('frequency_plot_data.csv', header = TRUE)
modern.table <- read.csv('modern_table_data.csv', header = TRUE)
modern <- read.csv('modern_fulltable_data.csv', header = TRUE)
dec.table <- read.csv('drasticdec_table_data.csv', header = TRUE)
inc.table <- read.csv('drasticinc_table_data.csv', header = TRUE)
bird.mod.locs <- read.csv('species_plotting_data.csv', header = TRUE)

#Make separate data.frames for each species that is decreasing
AMWO <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='American Woodcock')
 
YBFL <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Yellow-bellied Flycatcher')

BCNH <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Black-crowned Night-Heron')

#Make separate data.frames for each species that is increasing
BTBW <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Black-throated Blue Warbler')

EAPH <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Eastern Phoebe')

BLJA <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Blue Jay')

#MDI Map for species plots
mdi.map <- get_stamenmap(
  bbox = c(left = -68.5, bottom = 44.17, right = -68.13, top = 44.5),
  maptype = 'terrain',
  zoom = 11)

```

## How have bird species populations changed from 1880 to now?

### Summary

Bird species abundance and diversity has certainly changed between now and the 1880's when the Champlain Society was running field courses on Mount Desert Island (MDI). We compared the Champlain Society's species list that they kept over the 4 year duration they were active on MDI, to the past 4 years of eBird and iNaturalist data from 2018-2021. Today, there are `r length(which(modern$frequency.y=='common'))` common species on MDI, whereas in the early 1880's there were only `r length(which(modern$frequency.x=='common'))` common species. So, the diveristy of regularly occuring species has increased. **Table 1** lists all species that were not recorded historically or were rare, but are now common or have increased greatly since the 1880s. When looking at the changes of the species recorded historically we do see a `r (round(((length(which(freq.table$frequency.changes=='decreased'))*100)/88), digits=2))`% decrease in these species (**Fiugre 1**, **Table 3**). **Table 1** and **Table 2** highlight the species with noteable changes over the last 150 years. For a full list of changes to species see **Table 4**.


### Bar Graph of Species Changes



```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 1**. The bar graph shows changes in the species recorded by the Champlain Society in the 1880s.'}

freq.plot %>% 
  ggplot(aes(freq.changes, species.number, fill = freq.changes)) +
  geom_bar(stat="identity", color="black") +
  ggtitle("Species Frequency Changes from 1880 to Present") + 
  geom_text(aes(label = species.number, vjust = 2)) +
  guides(fill = 'none') +
  labs(x = "Change in Frequency", y = "Number of Species") +
  theme_classic(base_size=14) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values=c("forestgreen", "darkslategray4", "darkorange3"))

```




### Notably Increasing Species


**Table 1**. This table shows the species that have increased drastically in abundance since the 1880s. From this, we can infer that these species have expanded their range likely as a result of cliamte change and landscape change. There are `r length(which(modern.table$frequency=='common'))` species that are now common on MDI that were not present historically, and `r length(which(modern.table$frequency=='uncommon'))` species that are uncommon but regular and were not present historically.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(inc.table)

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 5**. Black-throated Blue Warbler (*Setophaga caerulescens*) distribution across MDI.'}

#BTBW
ggmap(mdi.map) +
  geom_point(data=BTBW,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black', 
             fill = '#006699',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  ggtitle("Black-throated Blue Warbler Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 6**. Blue Jay (*Cyanocitta cristata*) distribution across MDI.'}

#BLJA
ggmap(mdi.map) +
  geom_point(data=BLJA,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black',
             fill = '#0099FF',
             stroke = 1,
             alpha = 0.5) +
  theme_classic(base_size = 14 ) +
  ggtitle("Blue Jay Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 7**. Eastern Phoebe (*Sayornis phoebe*) distribution across MDI.'}

#EAPH
ggmap(mdi.map) +
  geom_point(data=EAPH,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black', 
             fill = '#996633',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  ggtitle("Eastern Phoebe Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```




### Noteably Decreasing Species


**Table 2**. This table shows the species that have decreased drastically in abundance since the 1880s.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(dec.table)

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 2**. American Woodcock (*Scolopax minor*) distribution across MDI.'}

#AMWO
ggmap(mdi.map) +
  geom_point(data=AMWO,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black', 
             fill = '#FF9933',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  ggtitle("American Woodcock Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 3**. Black-crowned Night-Heron (*Nycticorax nycticorax*) distribution across MDI.'}

#BCNH
ggmap(mdi.map) +
  geom_point(data=BCNH,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black', 
             fill = '#000000',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  ggtitle("Black-crowned Night-Heron Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='**Figure 4**. Yellow-bellied Flycatcher (*Empidonax flaviventris*) distribution across MDI.'}

#YBFL
ggmap(mdi.map) +
  geom_point(data=YBFL,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2.5,
             color = 'black', 
             fill = '#FFFF66',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  ggtitle("Yellow-bellied Flycatcher Distribution") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "longitude", y = "latitude")

```




### All Decreasing Species


**Table 3**. This table shows the species we know to have descreased in abundance since the 1880s.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

freq.table.dec <- freq.table %>% 
  filter(freq.table$frequency.changes == 'decreased')

knitr::kable(freq.table.dec)

```




### Total Species List Changes


**Table 5**. This table breaks down of all species recorded by the Champlain Society with their frquency status from the 1880s and today. If you look at the 'Changes in Frequency' column you can see how these species have changed from historic times.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(freq.table)

```

