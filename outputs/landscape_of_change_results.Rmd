---
title: "Landscape of Change Results" 
author: "Kyle Lima, Catherine Schmitt, Seth Benz, and Peter Nelson"
date: "February, 2022"
output:
  html_document:
    theme: readable
---

```{r setup, include=FALSE}
require(knitr)
require(utils)
require(dplyr)
require(ggplot2)
require(ggmap)
require(tidyverse)
require(graphics)
require(cowplot)
require(magick)
require(doBy)

#Read in data
freq.table <- read.csv('frequency_table_data.csv', header = TRUE)
freq.plot <- read.csv('frequency_plot_data.csv', header = TRUE)
modern.table <- read.csv('modern_table_data.csv', header = TRUE)
modern <- read.csv('modern_fulltable_data.csv', header = TRUE)
dec.table <- read.csv('drasticdec_table_data.csv', header = TRUE)
inc.table <- read.csv('drasticinc_table_data.csv', header = TRUE)
bird.mod.locs <- read.csv('species_plotting_data.csv', header = TRUE)
mod.proc <- read.csv('modernproctor_comparison_data.csv', header = TRUE)
inat.poll <- read.csv('inat_pollinator_data.csv', header = TRUE)
proc.poll <- read.csv('proctor_pollinator_data.csv', header = TRUE)
all.poll <- read.csv('all_pollinator_data.csv', header = TRUE)


#Draw images
fam.comp <- ggdraw() +
  draw_image("insect_freq_changes.png")
logo <- ggdraw() +
  draw_image("loc_logo.png")


#Make separate data.frames for each species that is decreasing
AMWO <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='American Woodcock')
 
YBFL <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Yellow-bellied Flycatcher')

BCNH <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Black-crowned Night-Heron')


#Make separate data.frames for each species that is increasing
BTBW <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Black-throated Blue Warbler')

EAPH <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Eastern Phoebe')

BLJA <- bird.mod.locs %>% 
  filter(bird.mod.locs$common.name=='Blue Jay')


#MDI Map for species plots
mdi.map <- get_stamenmap(
  bbox = c(left = -68.5, bottom = 44.17, right = -68.13, top = 44.5),
  maptype = 'toner-lite',
  zoom = 11)

```

```{r echo=FALSE, fig.align='center', out.height='50%', out.width='50%'}

plot(logo)

```

# Have Changes Occured Between 1880 and Now? {.tabset .tabset-fade .tabset-pills}



## Birds

### Results

How have bird species changed from 1880 to now? Most of us would probably assume there have been changes between now and the 1880’s when the Champlain Society was holding field courses on Mount Desert Island (MDI). However, to properly answer this question, we compared the Champlain Society’s records from 4 years of field courses, to the past 4 years of eBird and iNaturalist data from 2018 – 2021 on MDI.

What we found was quite interesting! The Champlain Society recorded `r length(freq.table$scientific.name)` species, which is less than half (`r round(((length(freq.table$scientific.name)/length(modern$scientific.name))*100), digits = 0)`%) of the `r length(modern$scientific.name)` species recorded in modern times by eBird and iNaturalist. Today, we see `r length(which(modern$frequency.y=='common')) - length(which(modern$frequency.x=='common'))` more species with a ‘common’ relative abundance (n = `r length(which(modern$frequency.y=='common'))`), than historically recorded (n = `r length(which(modern$frequency.x=='common'))`). We also looked at changes of historical species, and found that `r freq.plot[1,2]`% of these species increased in relative abundance (**Table 1**), `r freq.plot[2,2]`% decreased (**Table 2**), and `r freq.plot[3,2]`% exhibited no change (**Figure 1**). **Table 1** also includes more notably increasing species that were not even seen by the Champlain Society but are now 'uncommon' or 'common' on MDI. Some examples of the `r freq.plot[1,2]`% of historic species that have increased are Black-throated Blue Warbler (**Figure 2**), Blue Jay (**Figure 3**), and Eastern Phoebe (**Figure 4**). These species’ increases can be attributed to changes in the landscape such as human development, and the conversion of forests from boreal/coniferous to mixed/deciduous. Examples of the `r freq.plot[2,2]`% of historic species that have decreased are American Woodcock (**Figure 5**), Black-crowned Night-Heron (**Figure 6**), and Yellow-bellied Flycatcher (**Figure 7**). These species’ decreases could be attributed to changes in the landscape such as the loss of boreal forests, fields, and the infrastructural development by humans on the island.

We also wanted to look more closely at the species observed today, that were not recorded historically by the Champlain Society's efforts. There are `r length(modern.table$scientific.name)` species not recorded historically, but are regularly documented by observers today (**Table 3**). These species are those whose ranges have shifted north due to climate change, and those that can be attributed to human-caused changes on the landscape. This could include the changes to more deciduous forests, human development, and non-native species introduced by humans (e.g., House Sparrow, European Starling, etc.). For a complete list of relative abundance changes by species see **Table 4**.



<br>


### Species Changes

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap="**Figure 1**. This figure shows the number of bird species recorded by the Champlain Society in the 1880's that have increased, decreased, and showed no change in realtive abundance from the 1880's to present day. Data collected on Mount Desert Island, Maine, USA, and provided by eBird and iNaturalist."}

freq.plot %>% 
  ggplot(aes(freq.changes, species.number, fill = freq.changes)) +
  geom_bar(stat="identity", color="black") +
  ggtitle("Species Frequency Changes from 1880 to Present") + 
  geom_text(aes(label = species.number, vjust = 2)) +
  scale_y_continuous(breaks = scales::pretty_breaks(n = 6), expand = c(0,0), limits = c(0,80)) +
  guides(fill = 'none') +
  labs(x = "change in frequency", y = "number of species") +
  theme_classic(base_size=14) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values=c("forestgreen", "darkslategray4", "darkorange3"))

```

<br>

### Notably Increasing Species

**Table 1**. This table shows the species recorded by the Champlain Society with noteable increases in relative abundance. Also included are species with intensive increases in relative abundance that were not recored in the 1880's by the Champlain Society. There are `r length(which(modern.table$frequency=='common'))` species that are now 'common' on MDI, and `r length(which(modern.table$frequency=='uncommon'))` species that are 'uncommon' that were not present historically. Data collected on Mount Desert Island, Maine, USA, and provided by eBird and iNaturalist.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(inc.table, col.names = c('Common name', 'Scientific name', "R. a. 1880's", 'R. a. modern', 'R. a. changes'), caption = "'R. a.' = Relative abundance")

```
</details>

<br>
<br>

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 2**. Black-throated Blue Warbler (*Setophaga caerulescens*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#BTBW
map1 <- ggmap(mdi.map) +
  geom_point(data=BTBW,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black', 
             fill = '#006699',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x="", y="")

map1b <- ggdraw() +
  draw_image("BTBW.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map1)

map1b

```
<br>
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 3**. Blue Jay (*Cyanocitta cristata*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#BLJA
map2 <- ggmap(mdi.map) +
  geom_point(data=BLJA,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black',
             fill = '#0099FF',
             stroke = 1,
             alpha = 0.5) +
  theme_classic(base_size = 14 ) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x = "", y = "")

map2b <- ggdraw() +
  draw_image("BLJA.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map2)

map2b

```
<br>
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 4**. Eastern Phoebe (*Sayornis phoebe*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#EAPH
map3 <- ggmap(mdi.map) +
  geom_point(data=EAPH,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black', 
             fill = '#996633',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x = "", y = "")

map3b <- ggdraw() +
  draw_image("EAPH.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map3)

map3b

```


<br>

### Noteably Decreasing Species

**Table 2**. This table shows the species that exhibited noteable decreases in relative abundance since the 1880's. Data collected on Mount Desert Island, Maine, USA, and provided by eBird and iNaturalist.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(dec.table, col.names = c('Common name', 'Scientific name', "R. a. 1880's", 'R. a. modern', 'R. a. changes'), caption = "'R. a.' = Relative abundance")

```
</details>

<br>
<br>

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 5**. American Woodcock (*Scolopax minor*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#AMWO
map4 <- ggmap(mdi.map) +
  geom_point(data=AMWO,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black', 
             fill = '#FF9933',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x = "", y = "")

map4b <- ggdraw() +
  draw_image("AMWO.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map4)

map4b

```
<br>
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 6**. Black-crowned Night-Heron (*Nycticorax nycticorax*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#BCNH
map5 <- ggmap(mdi.map) +
  geom_point(data=BCNH,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black', 
             fill = '#000000',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x = "", y = "")

map5b <- ggdraw() +
  draw_image("BCNH.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map5)

map5b

```
<br>
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.cap='**Figure 7**. Yellow-bellied Flycatcher (*Empidonax flaviventris*) modern day distribution across MDI. Data provided by eBird and iNaturalist, 2018 - 2021.'}

#YBFL
map6 <- ggmap(mdi.map) +
  geom_point(data=YBFL,
             aes(x=longitude, y=latitude),
             shape = 21,
             size = 2,
             color = 'black', 
             fill = '#FFFF66',
             stroke = 1,
             alpha = 0.6) +
  theme_classic(base_size = 14 ) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.border=element_rect(colour = "black", fill=NA, size=1.5)) +
  labs(x = "", y = "")

map6b <- ggdraw() +
  draw_image("YBFL.jpg",  x = 0.4, y = 0, scale = .4) +
  draw_plot(map6)

map6b

```

<br>

### Modern Species not Recorded Historically

**Table 3**. This table shows the species that are seen regularly (those with the relative frequencies of rare, uncommon, and common) on MDI, but were not documented in the 1880's by the Champlain Society's efforts.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(modern.table, col.names = c('Common name', 'Scientific name', "Relative abundance"))

```
</details>

<br>


### Total Species List Changes

**Table 4**. This table breaks down of all species recorded by the Champlain Society with their relative abundances from the 1880's and today. Data collected on Mount Desert Island, Maine, USA, and provided by eBird and iNaturalist.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

freq.table <- freq.table %>% 
  select(-c('frequency.changes'))

knitr::kable(freq.table, col.names = c('Common name', 'Scientific name', "R. a. 1880's", 'R. a. modern'), caption = "'R. a.' = Relative abundance")

```
</details>
<br>

### Methodological Information

The historical dataset from the Champlain Society was collected from early July through the first week of September 1880 – 1883. To properly compare these data to modern day, we used eBird and iNaturalist data filtered to the same early July through the first week of September time frame, and over the same number of years from 2018 – 2021. To compare how often these species were/are detected, we had to create a qualitative descriptor properly assigned to the species as the historical dataset did not allow for a quantitative analysis. These designations were assigned based on the Champlain Society’s notes, and other sources describing species abundance around that time. For the modern dataset we used a count of the number of times a species was reported and designated a category based on these bins: < 5 = ‘very rare’, 5 > 20 = ‘rare’, 20 > 50 = ‘uncommon’, > 50 = ‘common.’

We used these detection frequencies to compare modern and historic times, and separated species with changes greater than one category into the ‘notably’ increasing or decreasing tables. For example, if a species was common in the 1880’s but is now uncommon, that would not constitute a notable change. Whereas, if a species was common in the 1880’s but is now rare, that would qualify as a notably decreasing species. We made this distinction considering the qualitative nature of our data with broad bins in which species were assigned, and on the basis that qualitative data like this should not be used to distinguish fine scale details.










## Insects

### Results


How have insects species changed from 1900 to now? To answer this question, we first delved into the efforts of the iNaturalist community and compared this to a historical collection of insects compiled by Proctor in the early 1900’s. On the initial look at these data, there was a stark difference between the two datasets. Proctor had collected 1360 species, while the iNaturalist community over the last 10 years only identified 362 species. Much of this can be attributed to the difference in methods: Proctor's specimen collection method vs. the far less invasive photo documentation of iNaturalist. While iNaturalist’s methods are much safer and less invasive, there are limitations as many insects can only be identified to species in the hand with equipment such as loupes, microscopes, etc. This means we need your help!! Community efforts by citizens scientists are invaluable, and can accomplish documentation on scales matched by no other. In order to properly make inferences from the iNaturalist dataset, we need more effort in and around Acadia National Park to document more species that are present in the area.
	
The modern iNaturalist community identified `r round(((length(which(mod.proc$order.y!='na'))/1360)*100), digits = 0)`% (n = `r length(which(mod.proc$order.y!='na'))`) of the 1360 species that Proctor documented in the 1900’s. Interestingly, the rest of the 362 species identified by the iNaturalist community (`r length(which(is.na(mod.proc$order.y)))` species) were not recorded by Proctor’s efforts, and were likely not present in the early 1900’s (**Table 1**). For a full look at the species diversity between all families, see **Figure 1**.
	
We also wanted to look more specifically at pollinating insects, and we saw a similar trend to the total dataset. There were `r length(unique(inat.poll$scientific.name))` pollinating species recorded by iNaturalist, and `r length(unique(proc.poll$scientific.name))` recorded by Proctor. iNaturalist recorded only `r round(((length(which(all.poll$order.y!='na'))/1360)*100), digits=0)`% (n = `r length(which(all.poll$order.y!='na'))`) of the `r length(unique(proc.poll$scientific.name))` pollinating species that Proctor documented. iNaturalist also identified `r length(which(is.na(all.poll$order.y)))` pollinating species that were not recorded by Proctor (**Table 2**). To look a little closer at pollinators, we explored just the bumblebees (*Bombus spp.*). 

Threatened and endangered species were another category we wanted to explore the status of on MDI. Historically, Proctor collected specimens of a Maine endangered species known as the [Edwards' Hairstreak](https://www.maine.gov/ifw/docs/endangered/edwardshairstreak_106_107.pdf) (*Satyrium edwardsii*). According to the MDIFW Endangered Species Program, this species today has only been found at three sites in southwestern Maine. The extensive reduction in abundance of this species can largely be attributed to the loss of their native habitat, pitch pine-scrub oak barrens, which have been reduced to less than 50% of their historic range (MDIFW Endangered Species Program, 2003).


<br>


### Modern Species not Recorded by Proctor

**Table 1**. This table shows the `r length(which(is.na(mod.proc$order.y)))` species that the iNaturalist community identified over the past 10 years, that were not recorded by Proctor in the 1900s. Data collected on Mount Desert Island, Maine, USA, and provided by iNaturalist and the National Park Service.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

  
mod.not.proc <- mod.proc %>% 
  filter(is.na(order.y)) %>% 
  select('order.x','super.family','family','scientific.name','common.name') %>% 
  rename('order'='order.x') %>% 
  order_by('super.family')

knitr::kable(mod.not.proc, col.names = c('Order', 'Super family', 'Family', 'Scientific name', 'Common name'))

```
</details>


<br>


### Comparisons by Insect Families

```{r, echo=FALSE, message=FALSE, warning=FALSE, out.width='700%', out.height='700%', fig.align='center', fig.cap="**Figure 1**. Comparison of the number of species by family from modern iNaturalist data and historical data collected by Proctor in the 1900's. Data collected on Mount Desert Island, Maine, USA, and provided by iNaturalist and the National Park Service."}

plot(fam.comp)


```


<br>


### Pollinators

**Table 2**. This table shows the `r length(which(is.na(all.poll$order.y)))` pollinating species that the iNaturalist community identified and were not recorded by Proctor in the 1900s. Data collected on Mount Desert Island, Maine, USA, and provided by iNaturalist and the National Park Service.

<br>

<details>
  <summary>**Click to show table**</summary>
```{r, echo=FALSE, message=FALSE, warning=FALSE}

  
all.not.proc <- all.poll %>% 
  filter(is.na(order.y)) %>% 
  select('order.x','super.family.x','family.x','scientific.name','common.name') %>% 
  rename('order'='order.x', 'super.family'='super.family.x','family'='family.x')

knitr::kable(all.not.proc, col.names = c('Order', 'Super family', 'Family', 'Scientific name', 'Common name'))

```
</details>
<br>